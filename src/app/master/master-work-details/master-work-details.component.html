<div class="row">
    <div class="col-sm-12">
        <app-card [title]="'Registro rutinas'" [headerContent]="''" [cardOptionBlock]="true">


            <h5>Información rutina </h5>
            <br>
            <h6 *ngIf=" showButtonUpdated == false">Luego de crear la rutina, puedes crear detalles</h6>
            <h6 *ngIf=" showButtonUpdated == true">Ya puedes crear detalles</h6>
            <br>
            <app-card [title]="'Encabezado'" [headerContent]="''" [cardOptionBlock]="true">

                <div class="form-group row">
                    <div class="col-sm-8 col-xs-12" *ngIf="showButtonUpdated == false">
                        <h6>Nombre de la Rutina <span style="color:red;">*</span></h6>
                        <input type="text" class="form-control" [(ngModel)]="title1" #ctrl="ngModel" id="worktitle" required>
                    </div>
                    <div class="col-sm-8 col-xs-12" *ngIf="showButtonUpdated == true">
                        <h6>Nombre de la Rutina <span style="color:red;">*</span></h6>
                        <input type="text" class="form-control" [(ngModel)]="title2" #ctrl="ngModel" id="worktitle2" required>
                    </div>
                    <!-- <div class="col-sm-1 editicon" *ngIf="showButtonUpdated == true">
                            <button (click)="updateheader(title2.value)" class="btn btn-primary btn-icon"><i class="icofont icofont-pencil-alt-5"></i></button>
                        </div> -->

                    <div class="col-sm-4 col-xs-12" *ngIf="showButtonUpdated == false">
                        <h6>Horas de la Rutina <span style="color:red;">*</span></h6>
                        <input type="number" class="form-control" [(ngModel)]="hours1" #ctrl="ngModel" id="workhours" required>
                    </div>
                    <div class="col-sm-4 col-xs-12" *ngIf="showButtonUpdated == true">
                        <h6>Horas de la Rutina <span style="color:red;">*</span></h6>
                        <input type="number" class="form-control" [(ngModel)]="hours2" #ctrl="ngModel" id="workhours2" required>
                    </div>
                </div>

                <div class="form-group row">
                    <div class="col-sm-12" *ngIf="showButtonUpdated == false">
                        <h6>Observacion de la Rutina <span style="color:red;"></span></h6>
                        <textarea type="text" class="form-control" [(ngModel)]="observation1" #ctrl="ngModel" id="workobservation" required></textarea>
                    </div>
                    <div class="col-sm-12" *ngIf="showButtonUpdated == true">
                        <h6>Observacion de la Rutina <span style="color:red;"></span></h6>
                        <textarea type="text" class="form-control" [(ngModel)]="observation2" #ctrl="ngModel" id="workobservation2" required></textarea>
                    </div>
                </div>

                <div class="form-group row">
                    <div class="col-sm-12 align-buttons">
                        <button (click)="updateheader()" type="submit" class="btn btn-primary m-b-0" *ngIf="showButtonUpdated == true">Actualizar encabezado <i class="icofont icofont-pencil-alt-5"></i></button>
                    </div>
                </div>
                <!-- <button class="btn btn-primary m-b-0" (click)="modalDetail.show()">Crear detalle</button>  -->
                <div class="form-group row align-buttons">
                    <div class="col-sm-12">
                        <button type="button" class="btn btn-primary m-b-0 waves-effect" id="storeheaderbutton" (click)="registerheader()" *ngIf="showButtonUpdated == false">Agregar encabezado</button>
                        <!-- <button (click)="registerheader()" id="registerHeader" type="submit" class="btn btn-primary m-b-0" *ngIf="showButtonUpdated == false">Agregar encabezado</button> -->
                        <button type="button" class="btn btn-default waves-effect" id="showmodalbutton" hidden (click)="modalUpdateDetail.show()">Cancelar</button>
                        <button type="button" class="btn btn-default waves-effect" id="storeheaderbutton2" hidden (click)="registerheader()">Cancelar</button>
                    </div>
                </div>
            </app-card>

            <div *ngIf="showButtonUpdated == true">
                <div class="align-buttons">
                    <button class="btn btn-primary m-b-0" (click)="modalDetail.show()" *ngIf="showButtonUpdated == true">Crear detalle</button>
                </div>
                <br>
                <ngx-datatable #table class="data-table" [rows]="rowsWorkDetails" [columns]="[{name:'Trabajo a realizar', prop:'works'},{name:'Partes', prop:'part'},{name:'Sistema', prop:'system'},{prop:'id'}]" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50"
                    [rowHeight]="'auto'" [limit]="5">

                    <ngx-datatable-column [resizeable]="false" name="Sistema" [sortable]="false" [draggable]="false" prop="system"></ngx-datatable-column>
                    <ngx-datatable-column [resizeable]="false" name="Partes" [sortable]="false" [draggable]="false" prop="part"></ngx-datatable-column>
                    <ngx-datatable-column [resizeable]="false" name="Trabajo a realizar" [sortable]="false" [draggable]="false" prop="works"></ngx-datatable-column>
                    <ngx-datatable-column [resizeable]="false" name="Acciones" [sortable]="false" [draggable]="false" sortable="false" prop="id">
                        <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            <button class="btn btn-primary btn-icon" (click)="showModalUpdate(row)"><i class="icofont icofont-pencil-alt-5"></i></button>
                            <button class="btn btn-danger btn-icon" (click)="deleteWorkDetail(row)"><i class="icofont icofont-ui-delete"></i></button>
                        </ng-template>
                    </ngx-datatable-column>
                </ngx-datatable>
                <br>
                <br>
        <div class="align-buttons">
            <button class="btn btn-primary m-b-0 " (click)="goAdminRoutines()">Volver Administración Rutinas</button>
        </div>

            </div>

        </app-card>
    </div>
</div>

<app-modal-basic #modalDetail [dialogClass]="'modal-lg'">
    <div class="app-modl-header">
        <h4 class="modal-title">Agregar detalle</h4>
    </div>
    <div class="app-modal-body">
        <form [formGroup]="detailform">
            <div class="form-group row">
                <div class="col-sm-12">
                    <h6>Sistema <span style="color:red;">*</span></h6>
                    <input type="text" class="form-control" id="system" formControlName="system">
                    <!-- <div *ngIf="submitted && detailform.system.errors" class="invalid-feedback">
                                <div class="messages text-danger" *ngIf="detailform.system.errors.required">Este campo es requerido</div>
                            </div> -->
                </div>
                <!-- <div class="col-sm-6">
                            <h6>Monta cargas <span style="color:red;">*</span></h6>
                            <select name="select" class="form-control" formControlName="forklift" [ngClass]="{ 'is-invalid': submitted && detailform.updateprofile.errors }">
                            <option selected value="">Selecione...</option>
                            <option value="1">motacargas opt1</option>
                            <option value="2">motacargas opt2</option>
                            <option value="3">motacargas opt3</option>
                            <option value="4">motacargas opt4</option>
                            </select>
                            <div *ngIf="submitted && detailform.updateprofile.errors" class="invalid-feedback">
                                <div class="messages text-danger" *ngIf="detailform.updateprofile.errors.required">Este campo es requerido</div>
                            </div>
                        </div> -->
            </div>
            <div class="form-group row">
                <!-- <div class="col-sm-3">
                            <h6>Hora inicio <span style="color:red;">*</span></h6>
                            <input type="text" class="form-control" id="start" formControlName="start" [ngClass]="{ 'is-invalid': submitted && detailform.updatename.errors }">
                            <div *ngIf="submitted && detailform.updatename.errors" class="invalid-feedback">
                                <div class="messages text-danger" *ngIf="detailform.updatename.errors.required">Este campo es requerido</div>
                            </div>

                        </div>
                        <div class="col-sm-3">
                            <h6>Hora fin <span style="color:red;">*</span></h6>
                            <input type="text" class="form-control" id="end" formControlName="end" [ngClass]="{ 'is-invalid': submitted && detailform.updatename.errors }">
                            <div *ngIf="submitted && detailform.updatename.errors" class="invalid-feedback">
                                <div class="messages text-danger" *ngIf="detailform.updatename.errors.required">Este campo es requerido</div>
                            </div>

                        </div> -->
                <div class="col-sm-12">
                    <div class="row">
                        <div class="col-sm-12 col-xs-12 col-md-12  col-lg-11">
                            <h6>Parte <span style="color:red;">*</span></h6>
                        </div>
                        <div class="col-sm-1" style="margin-top: -0.5%">
                            <button class="btn btn-warning btn-icon" (click)="addPart()"><i class="icofont icofont-ui-add"></i></button>
                        </div>
                    </div>
                    <br>
                    <div formArrayName="parts">
                        <div *ngFor="let part of getParts.controls;let pointIdex=index" [formGroupName]="pointIdex">
                            <div class="row">
                                <div class="col-sm-12 col-xs-12 col-md-12  col-lg-11">
                                    <input type="text" class="form-control " formControlName="part">
                                </div>
                                <div class="col-sm-1" style="margin-top: 0.5%">
                                    <button class="btn btn-default btn-icon " (click)="deletePart(pointIdex)"><i class="icofont icofont-ui-remove"></i></button>
                                </div>
                            </div>
                            <br>
                            <!-- <div *ngIf="submitted && detailform.part.errors" class="invalid-feedback">
                                        <div class="messages text-danger" *ngIf="detailform.part.errors.required">Este campo es requerido</div>
                                    </div> -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-12">
                    <h6>Trabajo a realizar <span style="color:red;">*</span></h6>
                    <textarea type="text" rows="5" class="form-control" id="comment" formControlName="comment"></textarea>
                </div>
            </div>
            <div class="align-buttons">
                <button type="button" class="btn btn-default waves-effect" id="storageDetailHide" (click)="modalDetail.hide()">Cancelar</button>
                <button type="submit " class="btn btn-primary m-b-0 " (click)="storageDetail(detailform.value)">Crear Detalle</button>

            </div>
        </form>
    </div>
</app-modal-basic>

<app-modal-basic #modalUpdateDetail [dialogClass]="'modal-lg'" >
    <div class="app-modl-header">
        <h4 class="modal-title">Actualizar detalle</h4>
    </div>
    <div class="app-modal-body">
        <form [formGroup]="updatedetailform">
            <div class="form-group row">
                <div class="col-sm-12">
                    <h6>Sistema <span style="color:red;">*</span></h6>
                    <input type="text" class="form-control" id="updatesystem" formControlName="updatesystem">
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-12">
                    <div class="row">
                        <div class="col-sm-12 col-xs-12 col-md-12  col-lg-11">
                            <h6>Parte <span style="color:red;">*</span></h6>
                        </div>
                        <div class="col-sm-1" style="margin-top: -0.5%">
                            <button class="btn btn-warning btn-icon" (click)="addUpdatePart()"><i class="icofont icofont-ui-add"></i></button>
                        </div>
                    </div>
                    <br>
                    <div formArrayName="updateparts">
                        <div *ngFor="let updatepart of getUpdateParts.controls;let updatePointIdex=index" [formGroupName]="updatePointIdex">
                            <div class="row">
                                <div class="col-sm-12 col-xs-12 col-md-12  col-lg-11">
                                    <input type="text" class="form-control" formControlName="updatepart">
                                </div>
                                <div class="col-sm-1" style="margin-top: 0.5%">
                                    <button class="btn btn-default btn-icon" (click)="deleteUpdatePart(updatePointIdex)"><i class="icofont icofont-ui-remove"></i></button>
                                </div>
                            </div>
                            <br>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-12">
                    <h6>Comentario <span style="color:red;">*</span></h6>
                    <textarea type="text" rows="5" class="form-control" id="updatecomment" formControlName="updatecomment"></textarea>
                </div>
            </div>
            <div class="align-buttons">
                <button type="button" class="btn btn-default waves-effect" id="updateDetailHide" (click)="modalUpdateDetail.hide()">Cancelar</button>
                <button type="submit " class="btn btn-primary m-b-0 " (click)="UpdateWorkDetail(updatedetailform.value)">Actualizar Detalle</button>

            </div>
        </form>
    </div>
</app-modal-basic>
